
<!DOCTYPE html>
<html>
<head>
    <title>Data Fixing System</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .upload-section { border: 2px dashed #ccc; padding: 20px; text-align: center; margin: 20px 0; }
        .results-section { margin: 20px 0; }
        .log-section { background: #f5f5f5; padding: 10px; margin: 10px 0; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        button { background: #4CAF50; color: white; padding: 10px 20px; border: none; cursor: pointer; }
        button:hover { background: #45a049; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ¤– Data Fixing System</h1>
        
        <div class="upload-section">
            <h2>Upload CSV File</h2>
            <input type="file" id="csvFile" accept=".csv">
            <button onclick="uploadFile()">Upload</button>
            <button onclick="processData()" id="processBtn" disabled>Process Data</button>
        </div>
        
        <div class="results-section" id="resultsSection" style="display: none;">
            <h2>Results</h2>
            <button onclick="downloadResults()">Download Cleaned Data</button>
            <div id="resultsTable"></div>
        </div>
        
        <div class="log-section" id="logSection" style="display: none;">
            <h2>Processing Logs</h2>
            <div id="logs"></div>
        </div>
    </div>
    
    <script>
        function uploadFile() {
            const fileInput = document.getElementById('csvFile');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Please select a file');
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('Error: ' + data.error);
                } else {
                    alert('File uploaded successfully!');
                    document.getElementById('processBtn').disabled = false;
                }
            })
            .catch(error => {
                alert('Error uploading file: ' + error);
            });
        }
        
        function processData() {
            fetch('/process', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('Error: ' + data.error);
                } else {
                    alert('Processing completed!');
                    loadResults();
                }
            })
            .catch(error => {
                alert('Error processing data: ' + error);
            });
        }
        
        function loadResults() {
            fetch('/results')
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('Error: ' + data.error);
                } else {
                    displayResults(data);
                }
            })
            .catch(error => {
                alert('Error loading results: ' + error);
            });
        }
        
        function displayResults(data) {
            const resultsSection = document.getElementById('resultsSection');
            const logSection = document.getElementById('logSection');
            
            // Display data table
            let tableHtml = '<table><tr>';
            data.columns.forEach(col => {
                tableHtml += '<th>' + col + '</th>';
            });
            tableHtml += '</tr>';
            
            data.data.forEach(row => {
                tableHtml += '<tr>';
                data.columns.forEach(col => {
                    tableHtml += '<td>' + (row[col] || '') + '</td>';
                });
                tableHtml += '</tr>';
            });
            tableHtml += '</table>';
            
            document.getElementById('resultsTable').innerHTML = tableHtml;
            resultsSection.style.display = 'block';
            
            // Display logs
            let logsHtml = '';
            for (const [logFile, logContent] of Object.entries(data.logs)) {
                logsHtml += '<h3>' + logFile + '</h3>';
                logsHtml += '<pre>' + logContent + '</pre>';
            }
            document.getElementById('logs').innerHTML = logsHtml;
            logSection.style.display = 'block';
        }
        
        function downloadResults() {
            window.location.href = '/download';
        }
    </script>
</body>
</html>
    